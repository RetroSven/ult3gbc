#include <gb.h>
#include "u3.h"

#define u3tiles ((unsigned char*)(0xB000))
#define tile_palettes ((unsigned char*)(0xB930))
#define tile_attribs  ((unsigned char*)(0xB990))
#define check_order ((unsigned char*)(0xB9F0))
#define bkg_p ((UWORD*)(0xBA40))
#define obj_p ((UWORD*)(0xBA80))
#define battlemaps ((UWORD*)(0xBAC0))

extern UBYTE yesnoglobal ;

extern UBYTE didfreezesfx ;

extern UBYTE whirldirectx ;
extern UBYTE whirldirecty ;

extern UBYTE cheat_nohurt ;
extern UBYTE omnieye ;

extern UBYTE frozennum ;

extern UBYTE generatorx ;
extern UBYTE generatory ;
extern UBYTE ingenerator ;

extern UBYTE numgoodies ;
extern UWORD windctr ;
extern UBYTE winddir ;
extern UWORD whirlctr ;

extern PLAYER players[] ;
extern MONSTER monsters[] ;
extern UBYTE nummonsters ;
extern UBYTE numplayers; 

extern UBYTE changemusic ;

extern UBYTE cheat_noblock ;

extern UBYTE inexodus ;
extern UBYTE die_exodus ;

extern UBYTE peermap ;

extern unsigned char varlist[120] ;

extern UWORD party_specials ;

extern UBYTE extragame ;
extern UBYTE volume_on ;

extern UBYTE playerx ;
extern UBYTE playery ;
extern UBYTE screenx ;
extern UBYTE screeny ;
extern UBYTE need_refresh ;
extern UBYTE inside ;
extern UBYTE transport ;

extern UBYTE numalive ;

extern UBYTE stoptime ;

extern unsigned char *vidbase ;

extern UBYTE delayscroll ;
extern UBYTE mode4tiles ;
extern UBYTE mode8tiles ;
extern unsigned char screenbuf3[] ;
extern UBYTE mapnum ;

unsigned char moondat[] = {
//0x87,0x78,0x88,0x5d,0x87,0x78,0x88
	0x95,0x5d,0xB0,0x5d,0xB0,0x5d,0x95
} ;


unsigned char expodat[] = {
	'A'+0x1D,'S'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'L'+0x1D,'E'+0x1D,'A'+0x1D,'V'+0x1D,'E'+0x1D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'C'+0x1D,'A'+0x1D,'S'+0x1D,'T'+0x1D,'L'+0x1D,'E'+0x1D,0x5D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'G'+0x1D,'R'+0x1D,'O'+0x1D,'U'+0x1D,'N'+0x1D,'D'+0x1D,0x5D,0x5D, 
	'B'+0x1D,'E'+0x1D,'G'+0x1D,'I'+0x1D,'N'+0x1D,'S'+0x1D,0x5D,'T'+0x1D,'O'+0x1D,0x5D,0x5D,0x5D, 
	'S'+0x1D,'H'+0x1D,'A'+0x1D,'K'+0x1D,'E'+0x1D,0x84U,0x84U,0x84U,0x5D,0x5D,0x5D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'A'+0x1D,'I'+0x1D,'R'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'A'+0x1D,'R'+0x1D,'O'+0x1D,'U'+0x1D,'N'+0x1D,'D'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,0x5D, 
	'S'+0x1D,'E'+0x1D,'E'+0x1D,'M'+0x1D,'S'+0x1D,0x5D,'T'+0x1D,'O'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'B'+0x1D,'E'+0x1D,'A'+0x1D,'R'+0x1D,0x5D,'D'+0x1D,'O'+0x1D,'W'+0x1D,'N'+0x1D,0x5D,0x5D,0x5D, 
	'U'+0x1D,'P'+0x1D,'O'+0x1D,'N'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,'R'+0x1D,0x5D,0x5D,0x5D, 
	'S'+0x1D,'H'+0x1D,'O'+0x1D,'U'+0x1D,'L'+0x1D,'D'+0x1D,'E'+0x1D,'R'+0x1D,'S'+0x1D,0x84U,0x84U,0x84U, 
	'A'+0x1D,'R'+0x1D,'C'+0x1D,'S'+0x1D,0x5D,'O'+0x1D,'F'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'P'+0x1D,'U'+0x1D,'R'+0x1D,'P'+0x1D,'L'+0x1D,'E'+0x1D,0x5D,'F'+0x1D,'I'+0x1D,'R'+0x1D,'E'+0x1D,0x5D, 
	'S'+0x1D,'H'+0x1D,'O'+0x1D,'O'+0x1D,'T'+0x1D,0x5D,'O'+0x1D,'U'+0x1D,'T'+0x1D,0x5D,0x5D,0x5D, 
	'F'+0x1D,'R'+0x1D,'O'+0x1D,'M'+0x1D,0x5D,'B'+0x1D,'E'+0x1D,'H'+0x1D,'I'+0x1D,'N'+0x1D,'D'+0x1D,0x84U, 
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'T'+0x1D,'U'+0x1D,'R'+0x1D,'N'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'A'+0x1D,'R'+0x1D,'O'+0x1D,'U'+0x1D,'N'+0x1D,'D'+0x1D,0x5D,'A'+0x1D,'N'+0x1D,'D'+0x1D,0x5D,0x5D, 
	'S'+0x1D,'E'+0x1D,'E'+0x1D,0x5D,'E'+0x1D,'X'+0x1D,'O'+0x1D,'D'+0x1D,'U'+0x1D,'S'+0x1D,0x5D,0x5D, 
	'E'+0x1D,'N'+0x1D,'V'+0x1D,'E'+0x1D,'L'+0x1D,'O'+0x1D,'P'+0x1D,'E'+0x1D,'D'+0x1D,0x5D,'I'+0x1D,'N'+0x1D, 
	'A'+0x1D,0x5D,'C'+0x1D,'O'+0x1D,'C'+0x1D,'O'+0x1D,'O'+0x1D,'N'+0x1D,0x5D,'O'+0x1D,'F'+0x1D,0x5D, 
	'P'+0x1D,'U'+0x1D,'L'+0x1D,'S'+0x1D,'A'+0x1D,'T'+0x1D,'I'+0x1D,'N'+0x1D,'G'+0x1D,0x5D,0x5D,0x5D, 
	'E'+0x1D,'N'+0x1D,'E'+0x1D,'R'+0x1D,'G'+0x1D,'Y'+0x1D,0x84U,0x5D,'F'+0x1D,'O'+0x1D,'R'+0x1D,0x5D, 
	'A'+0x1D,0x5D,'M'+0x1D,'O'+0x1D,'M'+0x1D,'E'+0x1D,'N'+0x1D,'T'+0x1D,0x85U,0x5D,0x5D,0x5D, 
	'T'+0x1D,'I'+0x1D,'M'+0x1D,'E'+0x1D,0x5D,'S'+0x1D,'E'+0x1D,'E'+0x1D,'M'+0x1D,'S'+0x1D,0x5D,0x5D, 
	'T'+0x1D,'O'+0x1D,0x5D,'S'+0x1D,'T'+0x1D,'O'+0x1D,'P'+0x1D,0x84U,0x84U,0x84U,0x5D,0x5D, 
	'S'+0x1D,'U'+0x1D,'D'+0x1D,'D'+0x1D,'E'+0x1D,'N'+0x1D,'L'+0x1D,'Y'+0x1D,0x85U,0x5D,'A'+0x1D,0x5D, 
	'T'+0x1D,'R'+0x1D,'E'+0x1D,'M'+0x1D,'E'+0x1D,'N'+0x1D,'D'+0x1D,'O'+0x1D,'U'+0x1D,'S'+0x1D,0x5D,0x5D, 
	'C'+0x1D,'A'+0x1D,'T'+0x1D,'A'+0x1D,'C'+0x1D,'L'+0x1D,'Y'+0x1D,'S'+0x1D,'M'+0x1D,0x5D,'O'+0x1D,'F'+0x1D, 
	'U'+0x1D,'N'+0x1D,'E'+0x1D,'A'+0x1D,'R'+0x1D,'T'+0x1D,'H'+0x1D,'L'+0x1D,'Y'+0x1D,0x5D,0x5D,0x5D, 
	'E'+0x1D,'N'+0x1D,'E'+0x1D,'R'+0x1D,'G'+0x1D,'Y'+0x1D,0x5D,'R'+0x1D,'I'+0x1D,'P'+0x1D,'S'+0x1D,0x5D, 
	'A'+0x1D,'P'+0x1D,'A'+0x1D,'R'+0x1D,'T'+0x1D,0x5D,'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D, 
	'W'+0x1D,'O'+0x1D,'R'+0x1D,'L'+0x1D,'D'+0x1D,0x5D,'A'+0x1D,'R'+0x1D,'O'+0x1D,'U'+0x1D,'N'+0x1D,'D'+0x1D, 
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x84U,0x5D,0x5D,'M'+0x1D,'A'+0x1D,'T'+0x1D,'T'+0x1D,'E'+0x1D,'R'+0x1D, 
	'S'+0x1D,'E'+0x1D,'E'+0x1D,'M'+0x1D,'S'+0x1D,0x5D,'T'+0x1D,'O'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'D'+0x1D,'R'+0x1D,'A'+0x1D,'I'+0x1D,'N'+0x1D,0x5D,'F'+0x1D,'R'+0x1D,'O'+0x1D,'M'+0x1D,0x5D,0x5D, 
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,'R'+0x1D,0x5D,'B'+0x1D,'O'+0x1D,'D'+0x1D,'I'+0x1D,'E'+0x1D,'S'+0x1D,0x5D, 
	'A'+0x1D,'S'+0x1D,0x5D,'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'T'+0x1D,'U'+0x1D,'M'+0x1D,'U'+0x1D,'L'+0x1D,'T'+0x1D,'U'+0x1D,'O'+0x1D,'U'+0x1D,'S'+0x1D,0x5D,0x5D, 
	'P'+0x1D,'H'+0x1D,'E'+0x1D,'N'+0x1D,'O'+0x1D,'M'+0x1D,'E'+0x1D,'N'+0x1D,'O'+0x1D,'N'+0x1D,0x5D,0x5D, 
	'C'+0x1D,'O'+0x1D,'N'+0x1D,'T'+0x1D,'I'+0x1D,'N'+0x1D,'U'+0x1D,'E'+0x1D,'S'+0x1D,0x84U,0x5D,0x5D, 
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'F'+0x1D,'L'+0x1D,'O'+0x1D,'A'+0x1D,'T'+0x1D,0x5D,0x5D,0x5D, 
	'I'+0x1D,'N'+0x1D,0x5D,'A'+0x1D,'W'+0x1D,'E'+0x1D,0x5D,'A'+0x1D,'S'+0x1D,0x5D,0x5D,0x5D, 
	'A'+0x1D,0x5D,'C'+0x1D,'O'+0x1D,'S'+0x1D,'M'+0x1D,'I'+0x1D,'C'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'E'+0x1D,'V'+0x1D,'O'+0x1D,'L'+0x1D,'U'+0x1D,'T'+0x1D,'I'+0x1D,'O'+0x1D,'N'+0x1D,0x5D,0x5D,0x5D, 
	'U'+0x1D,'N'+0x1D,'F'+0x1D,'O'+0x1D,'L'+0x1D,'D'+0x1D,'S'+0x1D,0x84U,0x5D,0x5D,0x5D,0x5D, 
	'E'+0x1D,'V'+0x1D,'E'+0x1D,'N'+0x1D,'T'+0x1D,'U'+0x1D,'A'+0x1D,'L'+0x1D,'L'+0x1D,'Y'+0x1D,0x5D,0x5D, 
	'F'+0x1D,'A'+0x1D,'M'+0x1D,'I'+0x1D,'L'+0x1D,'I'+0x1D,'A'+0x1D,'R'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'I'+0x1D,'M'+0x1D,'A'+0x1D,'G'+0x1D,'E'+0x1D,'S'+0x1D,0x5D,'T'+0x1D,'A'+0x1D,'K'+0x1D,'E'+0x1D,0x5D, 
	'S'+0x1D,'H'+0x1D,'A'+0x1D,'P'+0x1D,'E'+0x1D,0x5D,'B'+0x1D,'E'+0x1D,'F'+0x1D,'O'+0x1D,'R'+0x1D,'E'+0x1D, 
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x84U,0x84U,0x84U,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'E'+0x1D,'X'+0x1D,'O'+0x1D,'D'+0x1D,'U'+0x1D,'S'+0x1D,0x84U,0x84U,0x84U,0x5D,0x5D,0x5D, 
	'M'+0x1D,'O'+0x1D,'N'+0x1D,'D'+0x1D,'A'+0x1D,'I'+0x1D,'N'+0x1D,0x84U,0x84U,0x84U,0x5D,0x5D, 
	'M'+0x1D,'I'+0x1D,'N'+0x1D,'A'+0x1D,'X'+0x1D,0x84U,0x84U,0x84U,0x5D,0x5D,0x5D,0x5D, 
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'S'+0x1D,'E'+0x1D,'E'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,'R'+0x1D, 
	'S'+0x1D,'O'+0x1D,'R'+0x1D,'C'+0x1D,'E'+0x1D,'R'+0x1D,'O'+0x1D,'U'+0x1D,'S'+0x1D,0x5D,0x5D,0x5D, 
	'F'+0x1D,'O'+0x1D,'E'+0x1D,'S'+0x1D,0x5D,'T'+0x1D,'O'+0x1D,'I'+0x1D,'L'+0x1D,0x5D,0x5D,0x5D, 
	'O'+0x1D,'V'+0x1D,'E'+0x1D,'R'+0x1D,0x5D,'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'C'+0x1D,'R'+0x1D,'E'+0x1D,'A'+0x1D,'T'+0x1D,'I'+0x1D,'O'+0x1D,'N'+0x1D,0x5D,'O'+0x1D,'F'+0x1D,0x5D, 
	'E'+0x1D,'X'+0x1D,'O'+0x1D,'D'+0x1D,'U'+0x1D,'S'+0x1D,0x84U,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'A'+0x1D,'S'+0x1D,0x5D,'T'+0x1D,'H'+0x1D,'E'+0x1D,'Y'+0x1D,0x5D,'S'+0x1D,'E'+0x1D,'E'+0x1D,'M'+0x1D, 
	'T'+0x1D,'O'+0x1D,0x5D,'F'+0x1D,'I'+0x1D,'N'+0x1D,'I'+0x1D,'S'+0x1D,'H'+0x1D,0x5D,0x5D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,'I'+0x1D,'R'+0x1D,0x5D,'T'+0x1D,'A'+0x1D,'S'+0x1D,'K'+0x1D,0x5D,0x5D, 
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'W'+0x1D,'I'+0x1D,'T'+0x1D,'N'+0x1D,'E'+0x1D,'S'+0x1D,'S'+0x1D,0x5D, 
	'B'+0x1D,'O'+0x1D,'T'+0x1D,'H'+0x1D,0x5D,'O'+0x1D,'F'+0x1D,0x5D,'T'+0x1D,'H'+0x1D,'E'+0x1D,'M'+0x1D, 
	'L'+0x1D,'A'+0x1D,'Y'+0x1D,'I'+0x1D,'N'+0x1D,'G'+0x1D,0x5D,'T'+0x1D,'H'+0x1D,'E'+0x1D,'I'+0x1D,'R'+0x1D, 
	'H'+0x1D,'A'+0x1D,'N'+0x1D,'D'+0x1D,'S'+0x1D,0x5D,'U'+0x1D,'P'+0x1D,'O'+0x1D,'N'+0x1D,0x5D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,'I'+0x1D,'R'+0x1D,0x5D,'N'+0x1D,'E'+0x1D,'W'+0x1D,'L'+0x1D,'Y'+0x1D,0x5D, 
	'C'+0x1D,'R'+0x1D,'E'+0x1D,'A'+0x1D,'T'+0x1D,'E'+0x1D,'D'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'I'+0x1D,'N'+0x1D,'S'+0x1D,'T'+0x1D,'R'+0x1D,'U'+0x1D,'M'+0x1D,'E'+0x1D,'N'+0x1D,'T'+0x1D,0x5D,0x5D, 
	'O'+0x1D,'F'+0x1D,0x5D,'E'+0x1D,'V'+0x1D,'I'+0x1D,'L'+0x1D,0x84U,0x5D,0x5D,0x5D,0x5D, 
	'B'+0x1D,'O'+0x1D,'L'+0x1D,'T'+0x1D,'S'+0x1D,0x5D,'O'+0x1D,'F'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'L'+0x1D,'I'+0x1D,'G'+0x1D,'H'+0x1D,'T'+0x1D,0x5D,'S'+0x1D,'T'+0x1D,'R'+0x1D,'E'+0x1D,'A'+0x1D,'M'+0x1D, 
	'F'+0x1D,'O'+0x1D,'R'+0x1D,'T'+0x1D,'H'+0x1D,0x5D,'F'+0x1D,'R'+0x1D,'O'+0x1D,'M'+0x1D,0x5D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,'I'+0x1D,'R'+0x1D,0x5D,'F'+0x1D,'O'+0x1D,'R'+0x1D,'E'+0x1D,0x89U,0x5D, 
	'H'+0x1D,'E'+0x1D,'A'+0x1D,'D'+0x1D,'S'+0x1D,0x5D,'I'+0x1D,'N'+0x1D,'T'+0x1D,'O'+0x1D,0x5D,0x5D, 
	'E'+0x1D,'X'+0x1D,'O'+0x1D,'D'+0x1D,'U'+0x1D,'S'+0x1D,0x84U,0x5D,0x5D,'A'+0x1D,'S'+0x1D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,'Y'+0x1D,0x5D,'L'+0x1D,'I'+0x1D,'F'+0x1D,'T'+0x1D,0x5D,0x5D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,'I'+0x1D,'R'+0x1D,0x5D,'H'+0x1D,'A'+0x1D,'N'+0x1D,'D'+0x1D,'S'+0x1D,0x5D, 
	'F'+0x1D,'R'+0x1D,'O'+0x1D,'M'+0x1D,0x5D,'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'M'+0x1D,'A'+0x1D,'C'+0x1D,'H'+0x1D,'I'+0x1D,'N'+0x1D,'E'+0x1D,0x85U,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D, 
	'F'+0x1D,'E'+0x1D,'E'+0x1D,'L'+0x1D,0x5D,'A'+0x1D,0x5D,'S'+0x1D,'E'+0x1D,'N'+0x1D,'S'+0x1D,'E'+0x1D, 
	'O'+0x1D,'F'+0x1D,0x5D,'D'+0x1D,'R'+0x1D,'E'+0x1D,'A'+0x1D,'D'+0x1D,0x84U,0x5D,'I'+0x1D,'F'+0x1D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,'Y'+0x1D,0x5D,'I'+0x1D,'N'+0x1D,'D'+0x1D,'E'+0x1D,'E'+0x1D,'D'+0x1D,0x5D, 
	'S'+0x1D,'T'+0x1D,'O'+0x1D,'R'+0x1D,'E'+0x1D,'D'+0x1D,0x5D,'T'+0x1D,'H'+0x1D,'E'+0x1D,'I'+0x1D,'R'+0x1D, 
	'I'+0x1D,'N'+0x1D,'T'+0x1D,'E'+0x1D,'L'+0x1D,'L'+0x1D,'E'+0x1D,'C'+0x1D,'T'+0x1D,0x5D,0x5D,0x5D, 
	'I'+0x1D,'N'+0x1D,'T'+0x1D,'O'+0x1D,0x5D,'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'M'+0x1D,'E'+0x1D,'M'+0x1D,'O'+0x1D,'R'+0x1D,'Y'+0x1D,0x5D,'B'+0x1D,'A'+0x1D,'N'+0x1D,'K'+0x1D,'S'+0x1D, 
	'O'+0x1D,'F'+0x1D,0x5D,'E'+0x1D,'X'+0x1D,'O'+0x1D,'D'+0x1D,'U'+0x1D,'S'+0x1D,0x85U,0x5D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,'N'+0x1D,0x5D,'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'A'+0x1D,'B'+0x1D,'I'+0x1D,'L'+0x1D,'I'+0x1D,'T'+0x1D,'Y'+0x1D,0x5D,'T'+0x1D,'O'+0x1D,0x5D,0x5D, 
	'T'+0x1D,'R'+0x1D,'A'+0x1D,'V'+0x1D,'E'+0x1D,'L'+0x1D,0x5D,'I'+0x1D,'N'+0x1D,0x5D,0x5D,0x5D, 
	'T'+0x1D,'I'+0x1D,'M'+0x1D,'E'+0x1D,0x5D,'M'+0x1D,'I'+0x1D,'G'+0x1D,'H'+0x1D,'T'+0x1D,0x5D,0x5D, 
	'B'+0x1D,'E'+0x1D,0x5D,'A'+0x1D,'T'+0x1D,0x5D,'I'+0x1D,'T'+0x1D,'S'+0x1D,0x5D,0x5D,0x5D, 
	'D'+0x1D,'I'+0x1D,'S'+0x1D,'P'+0x1D,'O'+0x1D,'S'+0x1D,'A'+0x1D,'L'+0x1D,0x84U,0x5D,0x5D,0x5D, 
	'I'+0x1D,'N'+0x1D,'S'+0x1D,'T'+0x1D,'A'+0x1D,'N'+0x1D,'T'+0x1D,'L'+0x1D,'Y'+0x1D,0x5D,0x5D,0x5D, 
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'R'+0x1D,'E'+0x1D,'A'+0x1D,'L'+0x1D,'I'+0x1D,'Z'+0x1D,'E'+0x1D,0x5D, 
	'T'+0x1D,'H'+0x1D,'A'+0x1D,'T'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'A'+0x1D,'R'+0x1D,'E'+0x1D,0x5D,'I'+0x1D,'N'+0x1D,'D'+0x1D,'E'+0x1D,'E'+0x1D,'D'+0x1D,0x5D,0x5D, 
	'C'+0x1D,'A'+0x1D,'U'+0x1D,'G'+0x1D,'H'+0x1D,'T'+0x1D,0x5D,'U'+0x1D,'P'+0x1D,0x5D,0x5D,0x5D, 
	'I'+0x1D,'N'+0x1D,0x5D,'A'+0x1D,0x5D,'T'+0x1D,'I'+0x1D,'M'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D, 
	'R'+0x1D,'I'+0x1D,'F'+0x1D,'T'+0x1D,0x5D,'W'+0x1D,'I'+0x1D,'T'+0x1D,'H'+0x1D,0x5D,0x5D,0x5D, 
	'E'+0x1D,'X'+0x1D,'O'+0x1D,'D'+0x1D,'U'+0x1D,'S'+0x1D,0x5D,'A'+0x1D,'S'+0x1D,0x5D,'I'+0x1D,'T'+0x1D, 
	'T'+0x1D,'R'+0x1D,'A'+0x1D,'V'+0x1D,'E'+0x1D,'L'+0x1D,'S'+0x1D,0x5D,'B'+0x1D,'A'+0x1D,'C'+0x1D,'K'+0x1D, 
	'T'+0x1D,'O'+0x1D,0x5D,'R'+0x1D,'E'+0x1D,'J'+0x1D,'O'+0x1D,'I'+0x1D,'N'+0x1D,0x5D,0x5D,0x5D, 
	'I'+0x1D,'T'+0x1D,'S'+0x1D,0x5D,'C'+0x1D,'R'+0x1D,'E'+0x1D,'A'+0x1D,'T'+0x1D,'O'+0x1D,'R'+0x1D,'S'+0x1D, 
	'A'+0x1D,'N'+0x1D,'D'+0x1D,0x5D,'W'+0x1D,'R'+0x1D,'E'+0x1D,'A'+0x1D,'K'+0x1D,0x5D,0x5D,0x5D, 
	'H'+0x1D,'A'+0x1D,'V'+0x1D,'O'+0x1D,'K'+0x1D,0x5D,'O'+0x1D,'N'+0x1D,'C'+0x1D,'E'+0x1D,0x5D,0x5D, 
	'A'+0x1D,'G'+0x1D,'A'+0x1D,'I'+0x1D,'N'+0x1D,0x84U,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,0x5D, 
	'S'+0x1D,'T'+0x1D,'R'+0x1D,'U'+0x1D,'G'+0x1D,'G'+0x1D,'L'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'A'+0x1D,'G'+0x1D,'A'+0x1D,'I'+0x1D,'N'+0x1D,'S'+0x1D,'T'+0x1D,0x5D,'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D, 
	'C'+0x1D,'O'+0x1D,'S'+0x1D,'M'+0x1D,'I'+0x1D,'C'+0x1D,0x5D,'C'+0x1D,'U'+0x1D,'R'+0x1D,0x89U,0x5D, 
	'R'+0x1D,'E'+0x1D,'N'+0x1D,'T'+0x1D,0x5D,'T'+0x1D,'O'+0x1D,'W'+0x1D,'A'+0x1D,'R'+0x1D,'D'+0x1D,'S'+0x1D, 
	'E'+0x1D,'X'+0x1D,'O'+0x1D,'D'+0x1D,'U'+0x1D,'S'+0x1D,0x5D,'T'+0x1D,'O'+0x1D,0x5D,0x5D,0x5D, 
	'F'+0x1D,'I'+0x1D,'N'+0x1D,'A'+0x1D,'L'+0x1D,'L'+0x1D,'Y'+0x1D,0x5D,'E'+0x1D,'N'+0x1D,'D'+0x1D,0x5D, 
	'I'+0x1D,'T'+0x1D,'S'+0x1D,0x5D,'M'+0x1D,'A'+0x1D,'L'+0x1D,'E'+0x1D,'V'+0x1D,'O'+0x1D,0x89U,0x5D, 
	'L'+0x1D,'E'+0x1D,'N'+0x1D,'T'+0x1D,0x5D,'R'+0x1D,'E'+0x1D,'I'+0x1D,'G'+0x1D,'N'+0x1D,0x84U,0x5D, 
	'A'+0x1D,'S'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'S'+0x1D,'I'+0x1D,'N'+0x1D,'K'+0x1D,0x5D, 
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,'R'+0x1D,0x5D,'S'+0x1D,'W'+0x1D,'O'+0x1D,'R'+0x1D,'D'+0x1D,0x5D,0x5D, 
	'I'+0x1D,'N'+0x1D,'T'+0x1D,'O'+0x1D,0x5D,'I'+0x1D,'T'+0x1D,'S'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'E'+0x1D,'L'+0x1D,'E'+0x1D,'C'+0x1D,'T'+0x1D,'R'+0x1D,'O'+0x1D,'N'+0x1D,'I'+0x1D,'C'+0x1D,0x5D,0x5D, 
	'I'+0x1D,'N'+0x1D,'N'+0x1D,'A'+0x1D,'R'+0x1D,'T'+0x1D,'S'+0x1D,0x85U,0x5D,'A'+0x1D,'N'+0x1D,0x5D, 
	'E'+0x1D,'E'+0x1D,'R'+0x1D,'I'+0x1D,'E'+0x1D,0x5D,'N'+0x1D,'O'+0x1D,'I'+0x1D,'S'+0x1D,'E'+0x1D,0x5D, 
	'R'+0x1D,'I'+0x1D,'S'+0x1D,'E'+0x1D,'S'+0x1D,0x5D,'F'+0x1D,'R'+0x1D,'O'+0x1D,'M'+0x1D,0x5D,0x5D, 
	'I'+0x1D,'T'+0x1D,'S'+0x1D,0x5D,'B'+0x1D,'E'+0x1D,'L'+0x1D,'L'+0x1D,'O'+0x1D,'W'+0x1D,'S'+0x1D,0x84U, 
	'I'+0x1D,'N'+0x1D,'S'+0x1D,'T'+0x1D,'A'+0x1D,'N'+0x1D,'T'+0x1D,'L'+0x1D,'Y'+0x1D,0x5D,0x5D,0x5D, 
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,'R'+0x1D,0x5D,'V'+0x1D,'O'+0x1D,'Y'+0x1D,'A'+0x1D,'G'+0x1D,'E'+0x1D,0x5D, 
	'A'+0x1D,'C'+0x1D,'R'+0x1D,'O'+0x1D,'S'+0x1D,'S'+0x1D,0x5D,'T'+0x1D,'I'+0x1D,'M'+0x1D,'E'+0x1D,0x5D, 
	'C'+0x1D,'O'+0x1D,'M'+0x1D,'E'+0x1D,'S'+0x1D,0x5D,'T'+0x1D,'O'+0x1D,0x5D,'A'+0x1D,0x5D,0x5D, 
	'H'+0x1D,'A'+0x1D,'L'+0x1D,'T'+0x1D,0x5D,'A'+0x1D,'N'+0x1D,'D'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D, 
	'B'+0x1D,'E'+0x1D,'C'+0x1D,'O'+0x1D,'M'+0x1D,'E'+0x1D,0x5D,'A'+0x1D,'W'+0x1D,'A'+0x1D,'R'+0x1D,'E'+0x1D, 
	'T'+0x1D,'H'+0x1D,'A'+0x1D,'T'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'A'+0x1D,'R'+0x1D,'E'+0x1D, 
	'B'+0x1D,'A'+0x1D,'C'+0x1D,'K'+0x1D,0x5D,'I'+0x1D,'N'+0x1D,0x5D,'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D, 
	'C'+0x1D,'A'+0x1D,'S'+0x1D,'T'+0x1D,'L'+0x1D,'E'+0x1D,0x5D,'F'+0x1D,'R'+0x1D,'O'+0x1D,'M'+0x1D,0x5D, 
	'W'+0x1D,'H'+0x1D,'E'+0x1D,'N'+0x1D,'C'+0x1D,'E'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,0x5D, 
	'L'+0x1D,'E'+0x1D,'F'+0x1D,'T'+0x1D,0x84U,0x5D,'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D, 
	'S'+0x1D,'H'+0x1D,'O'+0x1D,'C'+0x1D,'K'+0x1D,0x5D,'W'+0x1D,'A'+0x1D,'V'+0x1D,'E'+0x1D,0x5D,0x5D, 
	'T'+0x1D,'H'+0x1D,'A'+0x1D,'T'+0x1D,0x5D,'E'+0x1D,'R'+0x1D,'U'+0x1D,'P'+0x1D,'T'+0x1D,'S'+0x1D,0x5D, 
	'F'+0x1D,'R'+0x1D,'O'+0x1D,'M'+0x1D,0x5D,'E'+0x1D,'X'+0x1D,'O'+0x1D,'D'+0x1D,'U'+0x1D,'S'+0x1D,0x5D, 
	'A'+0x1D,'N'+0x1D,'D'+0x1D,0x5D,'D'+0x1D,'E'+0x1D,'S'+0x1D,'T'+0x1D,'R'+0x1D,'O'+0x1D,'Y'+0x1D,'S'+0x1D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'C'+0x1D,'A'+0x1D,'S'+0x1D,'T'+0x1D,'L'+0x1D,'E'+0x1D,0x5D,0x5D, 
	'S'+0x1D,'E'+0x1D,'N'+0x1D,'D'+0x1D,'S'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,0x5D,0x5D, 
	'S'+0x1D,'O'+0x1D,'A'+0x1D,'R'+0x1D,'I'+0x1D,'N'+0x1D,'G'+0x1D,0x5D,'O'+0x1D,'U'+0x1D,'T'+0x1D,0x5D, 
	'O'+0x1D,'F'+0x1D,0x5D,'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'G'+0x1D,'A'+0x1D,'T'+0x1D,'E'+0x1D,'S'+0x1D, 
	'A'+0x1D,'N'+0x1D,'D'+0x1D,0x5D,'I'+0x1D,'N'+0x1D,'T'+0x1D,'O'+0x1D,0x5D,'A'+0x1D,0x5D,0x5D, 
	'S'+0x1D,'T'+0x1D,'R'+0x1D,'A'+0x1D,'N'+0x1D,'G'+0x1D,'E'+0x1D,0x5D,'N'+0x1D,'E'+0x1D,'W'+0x1D,0x5D, 
	'W'+0x1D,'O'+0x1D,'R'+0x1D,'L'+0x1D,'D'+0x1D,0x84U,0x84U,0x84U,0x84U,0x5D,0x5D,0x5D, 
} ; 

void newgame_expo()
{
	UBYTE ey, ex ;

	for ( ey = 0; ey != 29 ; ey++ )
	{
		for ( ex = 0; ex != 5 ; ex++ )
		{
			writegamemessage(expodat+(((UWORD)ey)*60L)+((UWORD)(ex*12))) ;
		}
		waitpadup() ;
		waitpad(0xFF) ;
	}

	writegamemessage(expodat+(29L*60L)) ;
	waitpadup() ;
	waitpad(0xFF) ;

}

void init_extra_game()
{
	UBYTE n ;

	inexodus = 0 ;
	die_exodus = 0 ;

	playerx = 31 ;
	playery = 27 ;
	nummonsters = 0 ;
	screenx = 26;
	screeny = 22;

	party_specials = 0L ;
	extragame = 1 ;

	transport = 0 ;

	memset(monsters,0,MONSTERSIZE*32L) ;
	monsters[31].x=3 ;
	monsters[31].y=38 ;
	monsters[31].attribs = 0x12 ;
	monsters[31].tile = 0x0F ; //0f

	for ( n=0 ; n!=numgoodies ; n++ )
	{
		players[n].gold = 100L ;
		players[n].keys=0U ;
		players[n].gems=0U ;
		players[n].markcard=0xFFU ;
		players[n].food = 200L ;
		if ( players[n].exp > 2400 )
			players[n].exp = 2400 ;
		if ( players[n].currHP > 2550 )
			players[n].currHP = 2550 ;
		if ( players[n].maxHP > 2550 )
			players[n].maxHP = 2550 ;

		players[n].powders=0U ;
		players[n].torches=0U ;
		memset(players[n].armors,0,8L) ;
		memset(players[n].weapons,0,16L) ;
		players[n].armor = 1 ;
		players[n].weapon = 1 ;
		players[n].armors[0] = 1 ;
		players[n].weapons[0] = 2 ;
		players[n].magic = 0 ;

		if ( players[n].str > 50 )
			players[n].str = 50 ;
		if ( players[n].dex > 50 )
			players[n].dex = 50 ;
		if ( players[n].wis > 50 )
			players[n].wis = 50 ;
		if ( players[n].intel > 50 )
			players[n].intel = 50 ;
	}

	volume_on = 1 ;

	peermap = 99U ; 

	inside = 0 ;

	generatorx = 0 ;
	generatory = 0 ;
	ingenerator = 0 ;

	changemusic = calcmusic( peermap ) ;

}
void formatnumber28(UWORD num,UBYTE length)
{
	UBYTE n ;
	unsigned char ch ;
	UWORD tens ;

	tens =1 ;

	for ( n=0 ; n<length-1 ; n++ )
		tens = tens*10 ;

	for ( n=0 ; n<length ; n++ )
	{
		ch=0x78U ; //'0'
		while ( num>= tens )
		{
			num -= tens ;
			ch++ ;
		}
		tens = tens/10 ;
		*((unsigned char*)screenbuf3+(UWORD)n) = ch ;


	}

}

unsigned char dirdat28[] = {
	'D'+0x1D,'I'+0x1D,'R'+0x1D,'E'+0x1D,'C'+0x1D,'T'+0x1D,'I'+0x1D,'O'+0x1D,'N'+0x1D,0x83,0x5d,0x5D
};

unsigned char dirarr28[] = {
	'N'+0x1D,'O'+0x1D,'R'+0x1D,'T'+0x1D,'H'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'S'+0x1D,'O'+0x1D,'U'+0x1D,'T'+0x1D,'H'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'E'+0x1D,'A'+0x1D,'S'+0x1D,'T'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'W'+0x1D,'E'+0x1D,'S'+0x1D,'T'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D, 
};

UBYTE getdir28()
{
	UBYTE dir, p, keys ;

	writegamemessage(dirdat28) ;

	waitpadup() ;
	dir = 0 ;
	while ( 1 )
	{
		keys = joypad() ;
		if ( keys&J_UP )
		{
			dir = 1 ;
			break ;
		}
		if ( keys&J_DOWN )
		{
			dir = 2 ;
			break ;
		}
		if ( keys&J_RIGHT )
		{
			dir = 3 ;
			break ;
		}
		if ( keys&J_LEFT )
		{
			dir = 4 ;
			break ;
		}
		if ( keys&J_B )
		{
			break ;
		}
	}       

	if ( dir )
	{
		writegamemessage(dirarr28+(((UWORD)(dir-1))*12L)) ;
	}

	waitpadup() ;
	return dir ;


}

void flashchar28(UBYTE pnum, UBYTE sfx)
{
	UBYTE q ;

	memset(screenbuf3,0x04,7L) ;
	disable_interrupts2();
	VBK_REG = 1 ;
	for ( q=0 ; q<4 ; q++ )
		set_bkg_tiles2(13,q+(pnum<<2)+1,7,1,(unsigned char*)screenbuf3) ;
	VBK_REG = 0 ;
	enable_interrupts2() ;
	playerhitsfx(170U);
	//delay(1250) ;
	disable_interrupts2();
	VBK_REG = 1 ;
	memset(screenbuf3,0x00,7L) ;
	for ( q=0 ; q<4 ; q++ )
		set_bkg_tiles2(13,q+(pnum<<2)+1,7,1,(unsigned char*)screenbuf3) ;
	VBK_REG = 0 ;
	enable_interrupts2();


}

unsigned char deaddat28[] = {
	'P'+0x1D,'L'+0x1D,'A'+0x1D,'Y'+0x1D,'E'+0x1D,'R'+0x1D,0x5D,'D'+0x1D,'E'+0x1D,'A'+0x1D,'D'+0x1D,0x82 
} ;

void damageplayer28(UBYTE pnum, UBYTE damage)
{
	if ( cheat_nohurt != 0 )
		return ;

	if ( (UWORD)damage < players[pnum].currHP )
		players[pnum].currHP -= (UWORD)damage ;
	else
	{
		players[pnum].currHP = 0L ;
		players[pnum].status = 0x02 ;
		numalive-- ;
		screenbuf3[0] = 'D'+0x1D ;
		disable_interrupts2() ;
		set_data2((unsigned char*)0x9800+19L+(32L*(2+(pnum<<2))),screenbuf3,1L) ;
		set_data2((unsigned char*)0x9C00+19L+(32L*(2+(pnum<<2))),screenbuf3,1L) ;
		enable_interrupts2() ;
		writegamemessage(deaddat28) ;

	}
	formatnumber28( (UWORD)(players[pnum].currHP),4) ;
	disable_interrupts2() ;
	set_data2((unsigned char*)0x9800+14L+(32L*(2+(pnum<<2))),(unsigned char*)screenbuf3,4L) ;
	set_data2((unsigned char*)0x9C00+14L+(32L*(2+(pnum<<2))),(unsigned char*)screenbuf3,4L) ;
	enable_interrupts2() ;


}

unsigned char noclimbdat[] = {
	'N'+0x1D,'O'+0x1D,0x5D,'M'+0x1D,'O'+0x1D,'U'+0x1D,'N'+0x1D,'T'+0x1D,'A'+0x1D,'I'+0x1D,'N'+0x1D,'S'+0x1D, 

} ;
unsigned char starvingdat28[] = {
	'S'+0x1D,'T'+0x1D,'A'+0x1D,'R'+0x1D,'V'+0x1D,'I'+0x1D,'N'+0x1D,'G'+0x1D,0x82,0x5D,0x5D,0x5D
};

UBYTE doclimb()
{
	UBYTE dir, placex, placey, p ;
	unsigned char atile ;

	dir = getdir28() ;

	if ( dir==0 )
		return 0 ;

	placex = playerx ;
	placey = playery ;

	switch ( dir )
	{
		case 1 ://north
			{
				placey = (placey + 63)&0x3F ;
				break ;
			}
		case 2 ://south
			{
				placey = (placey + 1)&0x3F ;
				break ;
			}
		case 3 ://east
			{
				placex = (placex + 1)&0x3F ;
				break ;
			}
		case 4 ://west
			{
				placex = (placex + 63)&0x3F ;
				break ;
			}
		default : break ;
	}

	atile = *((unsigned char*)0xA000+((UWORD)(((UWORD)(placey))<<6))+(UWORD)(placex)) ;

	if ( atile != 0x07 )
	{
		writegamemessage(noclimbdat) ;
		return 1 ;
	}

	playerx = placex ;
	playery = placey ;
	screenx = (playerx+59)&0x3F ;
	screeny = (playery+59)&0x3F ;

	for ( p=0 ; p<4 ; p++ )
	{
		if ( (players[p].inparty) &&( players[p].status <2) )
		{
			if ( players[p].food >= 40UL )
				players[p].food -= 40UL ;
			else
			{
				writegamemessage(starvingdat28) ;
				damageplayer28(p, (UBYTE)(40UL-players[p].food)) ;
				flashchar28(p,0) ;
				players[p].food = 0UL ;

			}
		}
		disable_interrupts2() ;
		formatnumber28( (UWORD)(players[p].food),4) ;
		set_data2((unsigned char*)0x9800+14L+(32L*(3+(p<<2))),(unsigned char*)screenbuf3,4L) ;
		set_data2((unsigned char*)0x9C00+14L+(32L*(3+(p<<2))),(unsigned char*)screenbuf3,4L) ;
		formatnumber28( (UWORD)(players[p].currHP),4) ;
		set_data2((unsigned char*)0x9800+14L+(32L*(2+(p<<2))),(unsigned char*)screenbuf3,4L) ;
		set_data2((unsigned char*)0x9C00+14L+(32L*(2+(p<<2))),(unsigned char*)screenbuf3,4L) ;
		enable_interrupts2() ;
	}

	return 1 ;
}


unsigned char frozendat[] = {
//peermap, x, y
	2, 6, 19,  //castle2
	2, 10, 19,
	2, 6, 25,
	2, 10, 25,
	2, 52, 25, 
	2, 53, 25, 
	2, 54, 25, 
	3, 28, 40, //dungeon2  7
	3, 29, 44,
	3, 31, 42,
	3, 33, 45,
	4, 16, 9,  //castle3  11
	4, 11, 14,
	4, 16, 14, 
	4, 21, 14,
	4, 11, 19,
	4, 16, 19,
	4, 21, 19,
	4, 16, 24,
	5, 29, 8,  //dungeon3  19
	5, 31, 14,
	5, 33, 14,
	5, 23, 22,
	5, 27, 21,
	5, 29, 27,
	5, 44, 20,
	5, 53, 27,
	6, 13, 24, //castle4  27
	6, 27, 18,
	6, 51, 24,
	6, 17, 40,
	6, 31, 34,
	6, 47, 38,
	7, 10, 24, //dungeon4  33
	7, 12, 20,
	7, 14, 18,
	7, 16, 22,
	7, 18, 16,
	7, 20, 22,
	7, 22, 16,
	7, 24, 18,
	7, 26, 20,
	7, 28, 24, 
	7, 30, 22,
	7, 32, 24,
	7, 34, 16,
	7, 36, 20,
	7, 38, 18,
	8, 19, 22,	//cast brit.  48
	9, 5, 6,	//rudan  49
	10, 5, 28,	//britain  50
	10, 5, 32,
	10, 59, 28,
	10, 59, 32,
	11, 5, 24,	//confusion  54
	13, 43, 62,	//proul  55
	14, 48, 50,	//pirate stronghold 56
	14, 51, 50,
	15, 43, 43,	//olympus 58
	99, 0, 0,
} ;

unsigned char frozenspecial[] = {
//flag indicating if town is special frozen, arrayoffset in frozendat, bit-byte indicating what's needed to trigger special effect
	0,0,0,
	0,0,0,
	1,0,7, //castle2
	1,21,4,	//dungeon2
	1,33,8,	//castle3
	1,57,8,	//dungeon3
	1,81,6,	//castle4
	1,99,15, //dungeon4
	1,144,1,  //cast. brit
	1,147,1,  //rudan
	1,150,4,  //britain
	1,162,1,  //confusion
	0,0,0,
	1,165,1, //proul
	1,168,2, //pirate stronghold
	1,174,1, //olympus
};

unsigned char frozenmaketileofs[] = {
//arrayoffset in frozenmaketile, number of tiles to make
	0,0,
	0,0,
	0,4, //castle2
	12,4, //dungeon2
	24,9, //castle3
	51,1, //dungeon3
	54,10, //castle4
	84,1, //dungeon4
	87,5,  //cast. brit
	102,3,	//rudan
	111,4,	//britain
	123,1,	//confusion
	0,0,
	126,1, //proul
	129,8, //pirate stronghold
	153,1, //olympus
};

unsigned char frozemaketile[] = {
	32, 15, 0,	//castle2  0
	31, 16, 0,
	33, 16, 0,
	32, 17, 0,
	30, 38, 0x04,  //dungeon2  4
	31, 38, 0x04,
	30, 47, 58,	   // 58 = wall
	31, 47, 58,
	41, 11, 11,	   // castle3, 11 = floor   8
	42, 11, 11,
	43, 11, 11,
	44, 11, 11,
	45, 11, 11,
	46, 11, 11,
	47, 11, 11,
	48, 11, 11,
	49, 11, 11,
	29, 4,  0x04,  //dungeon3   17
	12, 9,  11,	   //castle4   18
	52, 9,  11, 
	31, 3,  4, 
	32, 3,  4,
	33, 3,  4,
	31, 4,  4,
	33, 4,  4,
	31, 5,  4, 
	32, 5,  4,
	33, 5,  4,
	36, 33, 4,	  //dungeon4  28
	31, 45, 11,	  //cast britain  29
	33, 45, 11, 
	31, 51, 11,
	33, 51, 11,
	45, 48, 11,
	4, 8,   4,	  //rudan   34
	5, 8,   4,
	6, 8,   4,
	31, 29, 11,	  //britain   37
	33, 29, 11,
	31, 31, 11,
	33, 31, 11,
	3,  25, 11,	  //confusion   41
	24, 20, 14,	  //proul  14=ship   42
	45, 48, 4,	  //pirate stronghold   43
	45, 49, 4,
	54, 48, 4,
	54, 49, 4,
	45, 58, 4,
	45, 57, 5,
	54, 58, 4,
	54, 57, 5,
	41, 40, 4,	//olympus  51
} ;

void checkfrozen( UBYTE fx, UBYTE fy )
{
	UBYTE ofs1, ofs2, p, numtomake ;
	unsigned char atile ;
	UBYTE numfound ;

	ofs1 = peermap + peermap + peermap ;


	if ( frozenspecial[ofs1] != 0 )
	{
		ofs2 = frozenspecial[ofs1+1] ;
		p = 0 ;
		numfound = 0 ;

		while ( frozendat[ofs2] == peermap )
		{
			atile = *((unsigned char*)0xA000+((UWORD)(((UWORD)(frozendat[ofs2+2]))<<6))+(UWORD)(frozendat[ofs2+1])) ;

			if ( ( atile >= 13 ) && ( atile <= 36 ) )
			{
				numfound++ ;
			}
			else
				break ;

			ofs2 += 3 ;
		}           

		if ( numfound == frozenspecial[ofs1+2] )
		{
			didfreezesfx++ ;
			ofs1 = peermap + peermap ;
			ofs2 = frozenmaketileofs[ofs1] ;
			numtomake = frozenmaketileofs[ofs1+1] ;

			disable_interrupts2() ;

			for ( p = 0 ; p < numtomake ; p++ )
			{
				*((unsigned char*)0xA000+((UWORD)(((UWORD)(frozemaketile[ofs2+1]))<<6))+(UWORD)(frozemaketile[ofs2])) = frozemaketile[ofs2+2] ;
				SWITCH_RAM_MBC5(3) ;
				*((unsigned char*)0xA000+((UWORD)(((UWORD)(frozemaketile[ofs2+1]))<<6))+(UWORD)(frozemaketile[ofs2])) = frozemaketile[ofs2+2] ;
				SWITCH_RAM_MBC5(1) ;
				ofs2 += 3 ;
			}

			enable_interrupts2() ;

			specialsfx() ;

		}
	}
}

unsigned char noeffectdat28[] = {
	'N'+0x1D,'O'+0x1D,0x5D,'E'+0x1D,'F'+0x1D,'F'+0x1D,'E'+0x1D,'C'+0x1D,'T'+0x1D,0x5D,0x5D,0x5D, 
} ;

unsigned char frozendat28[] = {
	'F'+0x1D,'R'+0x1D,'O'+0x1D,'Z'+0x1D,'E'+0x1D,'N'+0x1D,0x82U,0x5D,0x5D,0x5D,0x5D,0x5D, 
} ;


UBYTE dofreeze()
{
	UBYTE dir, placex, placey, p, found, placex2, placey2 ;
	unsigned char atile ;
	unsigned char focustxt[13] ;

	if ( ( inside != 1 ) || ( didfreezesfx != 0 ) )
	{
		writegamemessage(noeffectdat28) ;
		return 1 ;
	}

	dir = getdir28() ;

	if ( dir==0 )
		return 0 ;

	placex = playerx ;
	placey = playery ;
	placex2 = playerx ;
	placey2 = playery ;

	switch ( dir )
	{
		case 1 ://north
			{
				placey = (playery + 63)&0x3F ;
				placey2 = (playery + 62)&0x3F ;
				break ;
			}
		case 2 ://south
			{
				placey = (playery + 1)&0x3F ;
				placey2 = (playery + 2)&0x3F ;
				break ;
			}
		case 3 ://east
			{
				placex = (playerx + 1)&0x3F ;
				placex2 = (playerx + 2)&0x3F ;
				break ;
			}
		case 4 ://west
			{
				placex = (playerx + 63)&0x3F ;
				placex2 = (playerx + 62)&0x3F ;
				break ;
			}
		default : break ;
	}


	atile = *((unsigned char*)0xA000+((UWORD)(((UWORD)(placey))<<6))+(UWORD)(placex)) ;


	if ( atile == 0x3A )
	{
		placex = placex2 ;
		placey = placey2 ;
	}

	p=0 ;
	found = 0 ;
	while ( (p<nummonsters) && (!found) )
		if ( (monsters[p].x==placex) && (monsters[p].y==placey) )
			found = 1 ;
		else
			p++	;

	if ( ( found == 1 ) && ( ( monsters[p].attribs & 0x0F ) != 0 ) )
	{
		writegamemessage(frozendat28) ;
		monsters[p].attribs = 0x00 ;

		checkfrozen( placex, placey ) ;


	}
	else
	{
		writegamemessage(noeffectdat28) ;
	}

	return 1 ;

}

unsigned char createforcedat28[] = {
	'C'+0x1D,'R'+0x1D,'E'+0x1D,'A'+0x1D,'T'+0x1D,'E'+0x1D,0x5D,'F'+0x1D,'O'+0x1D,'R'+0x1D,'C'+0x1D,'E'+0x1D, 

}; 

UBYTE doforce()
{
	UBYTE dir, placex, placey, p, found ;
	unsigned char atile ;

	if ( ( inside != 1 ) || ( didfreezesfx != 0 ) )
	{
		writegamemessage(noeffectdat28) ;
		return 1 ;
	}

	dir = getdir28() ;

	if ( dir==0 )
		return 0 ;

	placex = playerx ;
	placey = playery ;

	switch ( dir )
	{
		case 1 ://north
			{
				placey = (placey + 63)&0x3F ;
				break ;
			}
		case 2 ://south
			{
				placey = (placey + 1)&0x3F ;
				break ;
			}
		case 3 ://east
			{
				placex = (placex + 1)&0x3F ;
				break ;
			}
		case 4 ://west
			{
				placex = (placex + 63)&0x3F ;
				break ;
			}
		default : break ;
	}


	atile = *((unsigned char*)0xA000+((UWORD)(((UWORD)(placey))<<6))+(UWORD)(placex)) ;

	if ( ( atile == 0x04 ) || ( atile == 0x0B ) )
	{
		*((unsigned char*)0xA000+((UWORD)(((UWORD)(placey))<<6))+(UWORD)(placex)) = 0x26 ;
		writegamemessage(createforcedat28) ;
	}
	else
	{
		writegamemessage(noeffectdat28) ;
	}


	return 1 ;

}

unsigned char british28_1[] = {
	'W'+0x1D,'E'+0x1D,'L'+0x1D,'C'+0x1D,'O'+0x1D,'M'+0x1D,'E'+0x1D,0x5D,'M'+0x1D,'Y'+0x1D,0x5D,0x5D, 
};
unsigned char british28_2[] = {
	'N'+0x1D,'O'+0x1D,'B'+0x1D,'L'+0x1D,'E'+0x1D,'S'+0x1D,0x84,0x5D,0x5D,0x5D,0x5D,0x5D, 
};

unsigned char britishdone28[] = {
	'N'+0x1D,'O'+0x1D,0x5D,'M'+0x1D,'O'+0x1D,'R'+0x1D,'E'+0x1D,0x82,0x5D,0x5D,0x5D,0x5D, 
};



unsigned char britishup28_1[] = {
	'T'+0x1D,'H'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'A'+0x1D,'R'+0x1D,'T'+0x1D,0x5D,0x5D,0x5D,0x5D, 
};
unsigned char britishup28_2[] = {
	'G'+0x1D,'R'+0x1D,'E'+0x1D,'A'+0x1D,'T'+0x1D,'E'+0x1D,'R'+0x1D,0x82,0x5D,0x5D,0x5D,0x5D, 
};

unsigned char britishnotyet28_1[] = {
	'E'+0x1D,'X'+0x1D,'P'+0x1D,'E'+0x1D,'R'+0x1D,'I'+0x1D,'E'+0x1D,'N'+0x1D,'C'+0x1D,'E'+0x1D,0x5D,0x5D, 
};
unsigned char britishnotyet28_2[] = {
	'M'+0x1D,'O'+0x1D,'R'+0x1D,'E'+0x1D,0x82,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D, 
};

void magiceffect28(UBYTE spellnum)
{
	UBYTE p ;

	disable_interrupts2() ;
	VBK_REG=1 ;
	get_bkg_tiles2(1,1,11,11,(unsigned char*)0xBF80) ;

	for ( p=0 ; p < 121 ; p++ )
		if ( *((unsigned char*)0xBF80+(UWORD)p) < 4 )
			*((unsigned char*)0xBF80+(UWORD)p) += 4 ;

	set_bkg_tiles2(1,1,11,11,(unsigned char*)0xBF80) ;

	enable_interrupts2() ;

	magicsfx2(0,10+(spellnum*2),0) ;

	disable_interrupts2() ;
	for ( p=0 ; p < 121 ; p++ )
		if ( *((unsigned char*)0xBF80+(UWORD)p) > 3 )
			*((unsigned char*)0xBF80+(UWORD)p) -= 4 ;

	set_bkg_tiles2(1,1,11,11,(unsigned char*)0xBF80) ;
	VBK_REG=0 ;
	enable_interrupts2() ;

}

UBYTE dobow (UBYTE pnum )
{
	UBYTE reallevel, placex, placey ;
	unsigned char atile ;


	placey = playery ;
	if ( playerx == 0 )
		placex = 63 ;
	else
		placex = playerx-1 ;

	atile = *((unsigned char*)0xA000+((UWORD)(((UWORD)(placey))<<6))+(UWORD)(placex)) ;

	if ( atile != 0x19 )
	{
		writegamemessage(noeffectdat28) ;
		return 1 ;
	}

	changemusic = extragame ? 14 : 2 ;

	memset(screenbuf3,0x5D,12L) ;
	writegamemessage(british28_1) ;
	writegamemessage(british28_2) ;


	reallevel = ((UBYTE) (players[pnum].exp/100L))+1 ;
	if ( reallevel>players[pnum].level )
	{
		writegamemessage(screenbuf3) ;
		writegamemessage(britishup28_1) ;
		writegamemessage(britishup28_2) ;
		magiceffect28(4) ;
		players[pnum].maxHP = ((UWORD)(reallevel) * 100L ) + 50L; 
		players[pnum].currHP = players[pnum].maxHP;
		players[pnum].level = reallevel ;

	}
	else
	{
		if ( players[pnum].level == 99U )
		{
			writegamemessage(screenbuf3) ;
			writegamemessage(screenbuf3) ;
			writegamemessage(britishdone28) ;
		}
		else
		{
			writegamemessage(screenbuf3) ;
			writegamemessage(britishnotyet28_1) ;
			writegamemessage(britishnotyet28_2) ;

		}


	}

	return 1 ;  
}

unsigned char power28_1[] = {
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'N'+0x1D,'O'+0x1D,'W'+0x1D,0x5D,'H'+0x1D,'A'+0x1D,'V'+0x1D,'E'+0x1D, 
} ;

unsigned char power28_2[] = {
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'P'+0x1D,'O'+0x1D,'W'+0x1D,'E'+0x1D,'R'+0x1D,0x5D,'O'+0x1D,'F'+0x1D, 
} ;

unsigned char powersdat28[] = {
	'F'+0x1D,'R'+0x1D,'E'+0x1D,'E'+0x1D,'Z'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'F'+0x1D,'O'+0x1D,'R'+0x1D,'C'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'O'+0x1D,'M'+0x1D,'N'+0x1D,'I'+0x1D,'E'+0x1D,'Y'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'B'+0x1D,'U'+0x1D,'I'+0x1D,'L'+0x1D,'D'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D, 
} ;

unsigned char lackpiece28[] = {
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'L'+0x1D,'A'+0x1D,'C'+0x1D,'K'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'C'+0x1D,'O'+0x1D,'R'+0x1D,'R'+0x1D,'E'+0x1D,'C'+0x1D,'T'+0x1D,0x5D, 
	'E'+0x1D,'X'+0x1D,'O'+0x1D,'D'+0x1D,'U'+0x1D,'S'+0x1D,0x5D,'P'+0x1D,'I'+0x1D,'E'+0x1D,'C'+0x1D,'E'+0x1D, 
} ;

UBYTE doabsorb()
{
	UBYTE dir, placex, placey, p, found, powernum ;
	unsigned char atile ;

	if ( inside != 1 )
	{
		writegamemessage(noeffectdat28) ;
		return 1 ;
	}

	dir = getdir28() ;

	if ( dir==0 )
		return 0 ;

	placex = playerx ;
	placey = playery ;

	switch ( dir )
	{
		case 1 ://north
			{
				placey = (placey + 63)&0x3F ;
				break ;
			}
		case 2 ://south
			{
				placey = (placey + 1)&0x3F ;
				break ;
			}
		case 3 ://east
			{
				placex = (placex + 1)&0x3F ;
				break ;
			}
		case 4 ://west
			{
				placex = (placex + 63)&0x3F ;
				break ;
			}
		default : break ;
	}


	p=0 ;
	found = 0 ;
	while ( (p<nummonsters) && (!found) )
		if ( (monsters[p].x==placex) && (monsters[p].y==placey) )
			found = 1 ;
		else
			p++	;

	if ( ( found == 1 ) && ( monsters[p].tile==0x24 ) && ( monsters[p].attribs == 0x00 ) )
	{
		switch ( peermap )
		{
			case 1 : powernum = 1 ; break ;
			case 3 : powernum = 2 ; break ;
			case 5 : powernum = 3 ; break ;
			case 7 : powernum = 4 ; break ;
			default : powernum = 1 ; break ;
		}



		if ( powernum > 0 )
		{
			if ( ( party_specials >> (7+powernum) ) & 0x01 )
			{
				writegamemessage(power28_1) ;
				writegamemessage(power28_2) ;
				writegamemessage(powersdat28+(((UWORD)(powernum-1))*12UL)) ;
				switch ( powernum )
				{
					case 1 : party_specials |= 0x0004 ; break ;
					case 2 : party_specials |= 0x0008 ; break ;
					case 3 : party_specials |= 0x0010 ; break ;
					case 4 : party_specials |= 0x0040 ; break ;
					default  : break ;
				}
			}
			else
			{
				writegamemessage(lackpiece28) ;
				writegamemessage(lackpiece28+12UL) ;
				writegamemessage(lackpiece28+24UL) ;
			}

		}
	}
	else
	{
		writegamemessage(noeffectdat28) ;
	}

	return 1 ;

}

unsigned char finishgamedat[] = {
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'B'+0x1D,'R'+0x1D,'O'+0x1D,'K'+0x1D,'E'+0x1D,'N'+0x1D,0x5D,0x5D, 
	'P'+0x1D,'I'+0x1D,'E'+0x1D,'C'+0x1D,'E'+0x1D,'S'+0x1D,0x5D,'O'+0x1D,'F'+0x1D,0x5D,0x5D,0x5D, 
	'E'+0x1D,'X'+0x1D,'O'+0x1D,'D'+0x1D,'U'+0x1D,'S'+0x1D,0x5D,'S'+0x1D,'E'+0x1D,'E'+0x1D,'M'+0x1D,0x5D, 
	'T'+0x1D,'O'+0x1D,0x5D,'M'+0x1D,'E'+0x1D,'L'+0x1D,'T'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'T'+0x1D,'O'+0x1D,'G'+0x1D,'E'+0x1D,'T'+0x1D,'H'+0x1D,'E'+0x1D,'R'+0x1D,0x5D,0x5D,0x5D,0x5D, 

	'N'+0x1D,'E'+0x1D,'E'+0x1D,'D'+0x1D,'I'+0x1D,'N'+0x1D,'G'+0x1D,0x5D,'O'+0x1D,'N'+0x1D,'L'+0x1D,'Y'+0x1D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'S'+0x1D,'L'+0x1D,'I'+0x1D,'G'+0x1D,'H'+0x1D,'T'+0x1D,137U,0x5D, 
	'E'+0x1D,'S'+0x1D,'T'+0x1D,0x5D,'E'+0x1D,'N'+0x1D,'C'+0x1D,'O'+0x1D,'U'+0x1D,'R'+0x1D,137U,0x5D, 
	'A'+0x1D,'G'+0x1D,'E'+0x1D,'M'+0x1D,'E'+0x1D,'N'+0x1D,'T'+0x1D,0x5D,'T'+0x1D,'O'+0x1D,0x5D,0x5D, 
	'C'+0x1D,'O'+0x1D,'M'+0x1D,'B'+0x1D,'I'+0x1D,'N'+0x1D,'E'+0x1D,0x84U,0x5D,0x5D,0x5D,0x5D, 

	'A'+0x1D,'S'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'C'+0x1D,'O'+0x1D,'M'+0x1D,137U,0x5D, 
	'P'+0x1D,'L'+0x1D,'E'+0x1D,'T'+0x1D,'E'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,'R'+0x1D,0x5D,0x5D, 
	'T'+0x1D,'A'+0x1D,'S'+0x1D,'K'+0x1D,0x85U,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,0x5D,0x5D, 
/*
SEE LONG
FORGOTTEN
IMAGES FLASH
ACROSS ITS
SCREEN....
YOU SEE THE
DUNGEONS YOU
EXPLORED AND
THE BATTLES
YOU FOUGHT.
YOUR TRAVELS
AND ADVEN-
TURES ACROSS
THE EVER-
CHANGING
LAND OF
BRITANNIA
UNFOLD
BEFORE YOU
LIKE A LIV-
ING PICTURE
BOOK.  THEN
YOU SEE IT.
THE SPACE-
SHIP YOU
FLEW SO MANY
YEARS AGO.
YOUR MENTAL
REACTION TO
THE SIGHT
IMMEDIATELY
TRIGGERS A
RESPONSE IN
EXODUS AS IT
BEGINS TO
HUM LOUDLY.
IN A FLASH,
YOUR SPACE-
SHIP MATERI-
ALIZES
BEFORE YOU.
WASTING NO
TIME, YOU
CLIMB ABOARD
AND BLAST
OFF.  AS YOU
REACH ORBIT,
YOU BECOME
WITNESS TO
A DREADFUL
SIGHT.
*/

	'S'+0x1D,'E'+0x1D,'E'+0x1D,0x5D,'L'+0x1D,'O'+0x1D,'N'+0x1D,'G'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'F'+0x1D,'O'+0x1D,'R'+0x1D,'G'+0x1D,'O'+0x1D,'T'+0x1D,'T'+0x1D,'E'+0x1D,'N'+0x1D,0x5D,0x5D,0x5D, 

	'I'+0x1D,'M'+0x1D,'A'+0x1D,'G'+0x1D,'E'+0x1D,'S'+0x1D,0x5D,'F'+0x1D,'L'+0x1D,'A'+0x1D,'S'+0x1D,'H'+0x1D, 
	'A'+0x1D,'C'+0x1D,'R'+0x1D,'O'+0x1D,'S'+0x1D,'S'+0x1D,0x5D,'I'+0x1D,'T'+0x1D,'S'+0x1D,0x5D,0x5D, 
	'S'+0x1D,'C'+0x1D,'R'+0x1D,'E'+0x1D,'E'+0x1D,'N'+0x1D,0x84U,0x84U,0x84U,0x84U,0x5D,0x5D, 
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'S'+0x1D,'E'+0x1D,'E'+0x1D,0x5D,'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D, 
	'D'+0x1D,'U'+0x1D,'N'+0x1D,'G'+0x1D,'E'+0x1D,'O'+0x1D,'N'+0x1D,'S'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D, 

	'E'+0x1D,'X'+0x1D,'P'+0x1D,'L'+0x1D,'O'+0x1D,'R'+0x1D,'E'+0x1D,'D'+0x1D,0x5D,'A'+0x1D,'N'+0x1D,'D'+0x1D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'B'+0x1D,'A'+0x1D,'T'+0x1D,'T'+0x1D,'L'+0x1D,'E'+0x1D,'S'+0x1D,0x5D, 
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'F'+0x1D,'O'+0x1D,'U'+0x1D,'G'+0x1D,'H'+0x1D,'T'+0x1D,0x84U,0x5D, 
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,'R'+0x1D,0x5D,'T'+0x1D,'R'+0x1D,'A'+0x1D,'V'+0x1D,'E'+0x1D,'L'+0x1D,'S'+0x1D, 
	'A'+0x1D,'N'+0x1D,'D'+0x1D,0x5D,'A'+0x1D,'D'+0x1D,'V'+0x1D,'E'+0x1D,'N'+0x1D,137U,0x5D,0x5D, 

	'T'+0x1D,'U'+0x1D,'R'+0x1D,'E'+0x1D,'S'+0x1D,0x5D,'A'+0x1D,'C'+0x1D,'R'+0x1D,'O'+0x1D,'S'+0x1D,'S'+0x1D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'E'+0x1D,'V'+0x1D,'E'+0x1D,'R'+0x1D,137U,0x5D,0x5D,0x5D, 
	'C'+0x1D,'H'+0x1D,'A'+0x1D,'N'+0x1D,'G'+0x1D,'I'+0x1D,'N'+0x1D,'G'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'L'+0x1D,'A'+0x1D,'N'+0x1D,'D'+0x1D,0x5D,'O'+0x1D,'F'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'B'+0x1D,'R'+0x1D,'I'+0x1D,'T'+0x1D,'A'+0x1D,'N'+0x1D,'N'+0x1D,'I'+0x1D,'A'+0x1D,0x5D,0x5D,0x5D, 

	'U'+0x1D,'N'+0x1D,'F'+0x1D,'O'+0x1D,'L'+0x1D,'D'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'B'+0x1D,'E'+0x1D,'F'+0x1D,'O'+0x1D,'R'+0x1D,'E'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,0x5D, 
	'L'+0x1D,'I'+0x1D,'K'+0x1D,'E'+0x1D,0x5D,'A'+0x1D,0x5D,'L'+0x1D,'I'+0x1D,'V'+0x1D,137U,0x5D, 
	'I'+0x1D,'N'+0x1D,'G'+0x1D,0x5D,'P'+0x1D,'I'+0x1D,'C'+0x1D,'T'+0x1D,'U'+0x1D,'R'+0x1D,'E'+0x1D,0x5D, 
	'B'+0x1D,'O'+0x1D,'O'+0x1D,'K'+0x1D,0x84U,0x5D,0x5D,'T'+0x1D,'H'+0x1D,'E'+0x1D,'N'+0x1D,0x5D, 

	'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'S'+0x1D,'E'+0x1D,'E'+0x1D,0x5D,'I'+0x1D,'T'+0x1D,0x84U,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'S'+0x1D,'P'+0x1D,'A'+0x1D,'C'+0x1D,'E'+0x1D,137U,0x5D,0x5D, 
	'S'+0x1D,'H'+0x1D,'I'+0x1D,'P'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'F'+0x1D,'L'+0x1D,'E'+0x1D,'W'+0x1D,0x5D,'S'+0x1D,'O'+0x1D,0x5D,'M'+0x1D,'A'+0x1D,'N'+0x1D,'Y'+0x1D, 
	'Y'+0x1D,'E'+0x1D,'A'+0x1D,'R'+0x1D,'S'+0x1D,0x5D,'A'+0x1D,'G'+0x1D,'O'+0x1D,0x84U,0x5D,0x5D, 

	'Y'+0x1D,'O'+0x1D,'U'+0x1D,'R'+0x1D,0x5D,'M'+0x1D,'E'+0x1D,'N'+0x1D,'T'+0x1D,'A'+0x1D,'L'+0x1D,0x5D, 
	'R'+0x1D,'E'+0x1D,'A'+0x1D,'C'+0x1D,'T'+0x1D,'I'+0x1D,'O'+0x1D,'N'+0x1D,0x5D,'T'+0x1D,'O'+0x1D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'S'+0x1D,'I'+0x1D,'G'+0x1D,'H'+0x1D,'T'+0x1D,0x5D,0x5D,0x5D, 
	'I'+0x1D,'M'+0x1D,'M'+0x1D,'E'+0x1D,'D'+0x1D,'I'+0x1D,'A'+0x1D,'T'+0x1D,'E'+0x1D,'L'+0x1D,'Y'+0x1D,0x5D, 
	'T'+0x1D,'R'+0x1D,'I'+0x1D,'G'+0x1D,'G'+0x1D,'E'+0x1D,'R'+0x1D,'S'+0x1D,0x5D,'A'+0x1D,0x5D,0x5D, 

	'R'+0x1D,'E'+0x1D,'S'+0x1D,'P'+0x1D,'O'+0x1D,'N'+0x1D,'S'+0x1D,'E'+0x1D,0x5D,'I'+0x1D,'N'+0x1D,0x5D, 
	'E'+0x1D,'X'+0x1D,'O'+0x1D,'D'+0x1D,'U'+0x1D,'S'+0x1D,0x5D,'A'+0x1D,'S'+0x1D,0x5D,'I'+0x1D,'T'+0x1D, 
	'B'+0x1D,'E'+0x1D,'G'+0x1D,'I'+0x1D,'N'+0x1D,'S'+0x1D,0x5D,'T'+0x1D,'O'+0x1D,0x5D,0x5D,0x5D, 
	'H'+0x1D,'U'+0x1D,'M'+0x1D,0x5D,'L'+0x1D,'O'+0x1D,'U'+0x1D,'D'+0x1D,'L'+0x1D,'Y'+0x1D,0x84U,0x5D, 
	'I'+0x1D,'N'+0x1D,0x5D,'A'+0x1D,0x5D,'F'+0x1D,'L'+0x1D,'A'+0x1D,'S'+0x1D,'H'+0x1D,0x85U,0x5D, 

	'Y'+0x1D,'O'+0x1D,'U'+0x1D,'R'+0x1D,0x5D,'S'+0x1D,'P'+0x1D,'A'+0x1D,'C'+0x1D,'E'+0x1D,137U,0x5D, 
	'S'+0x1D,'H'+0x1D,'I'+0x1D,'P'+0x1D,0x5D,'M'+0x1D,'A'+0x1D,'T'+0x1D,'E'+0x1D,'R'+0x1D,'I'+0x1D,137U, 
	'A'+0x1D,'L'+0x1D,'I'+0x1D,'Z'+0x1D,'E'+0x1D,'S'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'B'+0x1D,'E'+0x1D,'F'+0x1D,'O'+0x1D,'R'+0x1D,'E'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x84U,0x5D, 
	'W'+0x1D,'A'+0x1D,'S'+0x1D,'T'+0x1D,'I'+0x1D,'N'+0x1D,'G'+0x1D,0x5D,'N'+0x1D,'O'+0x1D,0x5D,0x5D, 

	'T'+0x1D,'I'+0x1D,'M'+0x1D,'E'+0x1D,0x85U,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,0x5D,0x5D, 
	'C'+0x1D,'L'+0x1D,'I'+0x1D,'M'+0x1D,'B'+0x1D,0x5D,'A'+0x1D,'B'+0x1D,'O'+0x1D,'A'+0x1D,'R'+0x1D,'D'+0x1D, 
	'A'+0x1D,'N'+0x1D,'D'+0x1D,0x5D,'B'+0x1D,'L'+0x1D,'A'+0x1D,'S'+0x1D,'T'+0x1D,0x5D,0x5D,0x5D, 
	'O'+0x1D,'F'+0x1D,'F'+0x1D,0x84U,0x5D,0x5D,'A'+0x1D,'S'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D, 
	'R'+0x1D,'E'+0x1D,'A'+0x1D,'C'+0x1D,'H'+0x1D,0x5D,'O'+0x1D,'R'+0x1D,'B'+0x1D,'I'+0x1D,'T'+0x1D,0x85U, 

	'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'B'+0x1D,'E'+0x1D,'C'+0x1D,'O'+0x1D,'M'+0x1D,'E'+0x1D,0x5D,0x5D, 
	'W'+0x1D,'I'+0x1D,'T'+0x1D,'N'+0x1D,'E'+0x1D,'S'+0x1D,'S'+0x1D,0x5D,'T'+0x1D,'O'+0x1D,0x5D,0x5D, 
	'A'+0x1D,0x5D,'D'+0x1D,'R'+0x1D,'E'+0x1D,'A'+0x1D,'D'+0x1D,'F'+0x1D,'U'+0x1D,'L'+0x1D,0x5D,0x5D, 
	'S'+0x1D,'I'+0x1D,'G'+0x1D,'H'+0x1D,'T'+0x1D,0x84U,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'M'+0x1D,'O'+0x1D,'N'+0x1D,'D'+0x1D,'A'+0x1D,'I'+0x1D,'N'+0x1D,0x5D,'A'+0x1D,'N'+0x1D,'D'+0x1D,0x5D, 

	'M'+0x1D,'I'+0x1D,'N'+0x1D,'A'+0x1D,'X'+0x1D,0x5D,'H'+0x1D,'A'+0x1D,'V'+0x1D,'E'+0x1D,0x5D,0x5D, 
	'A'+0x1D,'S'+0x1D,'S'+0x1D,'E'+0x1D,'M'+0x1D,'B'+0x1D,'L'+0x1D,'E'+0x1D,'D'+0x1D,0x5D,0x5D,0x5D, 
	'A'+0x1D,0x5D,'L'+0x1D,'E'+0x1D,'G'+0x1D,'I'+0x1D,'O'+0x1D,'N'+0x1D,0x5D,'O'+0x1D,'F'+0x1D,0x5D, 
	'D'+0x1D,'E'+0x1D,'M'+0x1D,'O'+0x1D,'N'+0x1D,'I'+0x1D,'C'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'F'+0x1D,'O'+0x1D,'R'+0x1D,'C'+0x1D,'E'+0x1D,'S'+0x1D,0x5D,'T'+0x1D,'H'+0x1D,'A'+0x1D,'T'+0x1D,0x5D, 

	'S'+0x1D,'T'+0x1D,'A'+0x1D,'N'+0x1D,'D'+0x1D,0x5D,'P'+0x1D,'O'+0x1D,'I'+0x1D,'S'+0x1D,'E'+0x1D,'D'+0x1D, 
	'T'+0x1D,'O'+0x1D,0x5D,'D'+0x1D,'E'+0x1D,'S'+0x1D,'T'+0x1D,'R'+0x1D,'O'+0x1D,'Y'+0x1D,0x5D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'W'+0x1D,'O'+0x1D,'R'+0x1D,'L'+0x1D,'D'+0x1D,0x5D,'O'+0x1D,'F'+0x1D, 
	'U'+0x1D,'L'+0x1D,'T'+0x1D,'I'+0x1D,'M'+0x1D,'A'+0x1D,0x82U,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'I'+0x1D,'N'+0x1D,'S'+0x1D,'T'+0x1D,'A'+0x1D,'N'+0x1D,'T'+0x1D,'L'+0x1D,'Y'+0x1D,0x5D,0x5D,0x5D, 

	'U'+0x1D,'P'+0x1D,'O'+0x1D,'N'+0x1D,0x5D,'S'+0x1D,'E'+0x1D,'E'+0x1D,'I'+0x1D,'N'+0x1D,'G'+0x1D,0x5D, 
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,'R'+0x1D,0x5D,'S'+0x1D,'H'+0x1D,'I'+0x1D,'P'+0x1D,0x85U,0x5D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'W'+0x1D,'I'+0x1D,'Z'+0x1D,'A'+0x1D,'R'+0x1D,'D'+0x1D,'S'+0x1D,0x5D, 
	'G'+0x1D,'I'+0x1D,'V'+0x1D,'E'+0x1D,0x5D,'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'O'+0x1D,'R'+0x1D,'D'+0x1D,'E'+0x1D,'R'+0x1D,0x5D,'T'+0x1D,'O'+0x1D,0x5D,0x5D,0x5D,0x5D, 

	'A'+0x1D,'T'+0x1D,'T'+0x1D,'A'+0x1D,'C'+0x1D,'K'+0x1D,0x82U,0x5D,0x5D,0x5D,0x5D,0x5D, 

};

unsigned char instructionsdat[] = {
	'T'+0x1D,'O'+0x1D,0x5D,'D'+0x1D,'E'+0x1D,'F'+0x1D,'E'+0x1D,'A'+0x1D,'T'+0x1D,0x5D,0x5D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'W'+0x1D,'I'+0x1D,'Z'+0x1D,'A'+0x1D,'R'+0x1D,'D'+0x1D,'S'+0x1D,0x85U, 
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'M'+0x1D,'U'+0x1D,'S'+0x1D,'T'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'R'+0x1D,'E'+0x1D,'P'+0x1D,'E'+0x1D,'L'+0x1D,0x5D,'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D, 
	'A'+0x1D,'L'+0x1D,'I'+0x1D,'E'+0x1D,'N'+0x1D,0x5D,'A'+0x1D,'T'+0x1D,'T'+0x1D,'A'+0x1D,'C'+0x1D,'K'+0x1D, 

	'A'+0x1D,'N'+0x1D,'D'+0x1D,0x5D,'P'+0x1D,'R'+0x1D,'O'+0x1D,'T'+0x1D,'E'+0x1D,'C'+0x1D,'T'+0x1D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'W'+0x1D,'O'+0x1D,'R'+0x1D,'L'+0x1D,'D'+0x1D,0x5D,0x5D,0x5D, 
	'F'+0x1D,'R'+0x1D,'O'+0x1D,'M'+0x1D,0x5D,'D'+0x1D,'E'+0x1D,'S'+0x1D,137U,0x5D,0x5D,0x5D, 
	'T'+0x1D,'R'+0x1D,'U'+0x1D,'C'+0x1D,'T'+0x1D,'I'+0x1D,'O'+0x1D,'N'+0x1D,0x84U,0x5D,0x5D,0x5D, 
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'M'+0x1D,'U'+0x1D,'S'+0x1D,'T'+0x1D,0x5D,0x5D,0x5D,0x5D, 

	'D'+0x1D,'E'+0x1D,'S'+0x1D,'T'+0x1D,'R'+0x1D,'O'+0x1D,'Y'+0x1D,0x5D,'A'+0x1D,'T'+0x1D,0x5D,0x5D, 
	'L'+0x1D,'E'+0x1D,'A'+0x1D,'S'+0x1D,'T'+0x1D,0x5D,'2'+0x48U,'0'+0x48U,'0'+0x48U,0x5D,0x5D,0x5D, 
	'E'+0x1D,'N'+0x1D,'E'+0x1D,'M'+0x1D,'I'+0x1D,'E'+0x1D,'S'+0x1D,0x5D,'A'+0x1D,'N'+0x1D,'D'+0x1D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'W'+0x1D,'O'+0x1D,'R'+0x1D,'L'+0x1D,'D'+0x1D,0x5D,0x5D,0x5D, 
	'M'+0x1D,'U'+0x1D,'S'+0x1D,'T'+0x1D,0x5D,'N'+0x1D,'O'+0x1D,'T'+0x1D,0x5D,'B'+0x1D,'E'+0x1D,0x5D, 

	'H'+0x1D,'I'+0x1D,'T'+0x1D,0x5D,'M'+0x1D,'O'+0x1D,'R'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'T'+0x1D,'H'+0x1D,'A'+0x1D,'N'+0x1D,0x5D,'1'+0x48,'0'+0x48,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'T'+0x1D,'I'+0x1D,'M'+0x1D,'E'+0x1D,'S'+0x1D,0x84U,0x5D,0x5D,'U'+0x1D,'S'+0x1D,'E'+0x1D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'D'+0x1D,137U,'P'+0x1D,'A'+0x1D,'D'+0x1D,0x5D,'T'+0x1D,'O'+0x1D, 
	'M'+0x1D,'O'+0x1D,'V'+0x1D,'E'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,'R'+0x1D,0x5D,0x5D,0x5D, 

	'S'+0x1D,'H'+0x1D,'I'+0x1D,'P'+0x1D,0x5D,'A'+0x1D,'R'+0x1D,'O'+0x1D,'U'+0x1D,'N'+0x1D,'D'+0x1D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'W'+0x1D,'O'+0x1D,'R'+0x1D,'L'+0x1D,'D'+0x1D,0x84U,0x5D,0x5D, 
	'B'+0x1D,'U'+0x1D,'T'+0x1D,'T'+0x1D,'O'+0x1D,'N'+0x1D,0x5D,'A'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'W'+0x1D,'I'+0x1D,'L'+0x1D,'L'+0x1D,0x5D,'F'+0x1D,'I'+0x1D,'R'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D, 
	'A'+0x1D,'N'+0x1D,'D'+0x1D,0x5D,'B'+0x1D,'U'+0x1D,'T'+0x1D,'T'+0x1D,'O'+0x1D,'N'+0x1D,0x5D,'B'+0x1D, 

	'W'+0x1D,'I'+0x1D,'L'+0x1D,'L'+0x1D,0x5D,'R'+0x1D,'A'+0x1D,'I'+0x1D,'S'+0x1D,'E'+0x1D,0x5D,0x5D, 
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,'R'+0x1D,0x5D,'S'+0x1D,'H'+0x1D,'I'+0x1D,'E'+0x1D,'L'+0x1D,'D'+0x1D,'S'+0x1D, 
	'B'+0x1D,'U'+0x1D,'T'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,'R'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'S'+0x1D,'H'+0x1D,'I'+0x1D,'E'+0x1D,'L'+0x1D,'D'+0x1D,0x5D,'E'+0x1D,'N'+0x1D,137U,0x5D,0x5D, 
	'E'+0x1D,'R'+0x1D,'G'+0x1D,'Y'+0x1D,0x5D,'D'+0x1D,'R'+0x1D,'A'+0x1D,'I'+0x1D,'N'+0x1D,'S'+0x1D,0x5D, 

	'A'+0x1D,'S'+0x1D,0x5D,'L'+0x1D,'O'+0x1D,'N'+0x1D,'G'+0x1D,0x5D,'A'+0x1D,'S'+0x1D,0x5D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,'Y'+0x1D,0x5D,'A'+0x1D,'R'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'R'+0x1D,'A'+0x1D,'I'+0x1D,'S'+0x1D,'E'+0x1D,'D'+0x1D,0x84U,0x5D,'W'+0x1D,'H'+0x1D,'E'+0x1D,'N'+0x1D, 
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,'R'+0x1D,0x5D,'S'+0x1D,'H'+0x1D,'I'+0x1D,'E'+0x1D,'L'+0x1D,'D'+0x1D,'S'+0x1D, 
	'A'+0x1D,'R'+0x1D,'E'+0x1D,0x5D,'D'+0x1D,'O'+0x1D,'W'+0x1D,'N'+0x1D,0x85U,0x5D,0x5D,0x5D, 

	'Y'+0x1D,'O'+0x1D,'U'+0x1D,'R'+0x1D,0x5D,'S'+0x1D,'H'+0x1D,'I'+0x1D,'E'+0x1D,'L'+0x1D,'D'+0x1D,0x5D, 
	'E'+0x1D,'N'+0x1D,'E'+0x1D,'R'+0x1D,'G'+0x1D,'Y'+0x1D,0x5D,'W'+0x1D,'I'+0x1D,'L'+0x1D,'L'+0x1D,0x5D, 
	'B'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'R'+0x1D,'E'+0x1D,'P'+0x1D,'L'+0x1D,'E'+0x1D,'N'+0x1D,'I'+0x1D,'S'+0x1D,'H'+0x1D,'E'+0x1D,'D'+0x1D,0x84U, 
	'P'+0x1D,'R'+0x1D,'E'+0x1D,'S'+0x1D,'S'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D, 

	'S'+0x1D,'T'+0x1D,'A'+0x1D,'R'+0x1D,'T'+0x1D,145U,'L'+0x1D,0x5D,'O'+0x1D,'R'+0x1D,0x5D,0x5D, 
	'S'+0x1D,'T'+0x1D,'A'+0x1D,'R'+0x1D,'T'+0x1D,145U,'R'+0x1D,0x5D,'T'+0x1D,'O'+0x1D,0x5D,0x5D, 
	'R'+0x1D,'O'+0x1D,'T'+0x1D,'A'+0x1D,'T'+0x1D,'E'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,'R'+0x1D,0x5D, 
	'S'+0x1D,'H'+0x1D,'I'+0x1D,'P'+0x1D,0x5D,'L'+0x1D,'E'+0x1D,'F'+0x1D,'T'+0x1D,0x5D,'O'+0x1D,'R'+0x1D, 
	'R'+0x1D,'I'+0x1D,'G'+0x1D,'H'+0x1D,'T'+0x1D,0x84U,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D, 

};

unsigned char repeatdat[] = 
{

	0x5D, 0x5D, 0x5D, 0x5D, 0x5D, 0x5D, 0x5D, 0x5D, 0x5D, 0x5D, 0x5D, 0x5D, 
	'D'+0x1D,'O'+0x1D,0x5D,'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'W'+0x1D,'A'+0x1D,'N'+0x1D,'T'+0x1D,0x5D, 
	'T'+0x1D,'O'+0x1D,0x5D,'R'+0x1D,'E'+0x1D,'P'+0x1D,'E'+0x1D,'A'+0x1D,'T'+0x1D,0x5D,0x5D,0x5D, 
	'T'+0x1D,'H'+0x1D,'E'+0x1D,0x5D,'I'+0x1D,'N'+0x1D,'S'+0x1D,'T'+0x1D,'R'+0x1D,'U'+0x1D,'C'+0x1D,137U, 
	'T'+0x1D,'I'+0x1D,'O'+0x1D,'N'+0x1D,'S'+0x1D,0x83U,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D, 
};

unsigned char goodluckdat[]={


	'G'+0x1D,'O'+0x1D,'O'+0x1D,'D'+0x1D,0x5D,'L'+0x1D,'U'+0x1D,'C'+0x1D,'K'+0x1D,0x82U,0x5D,0x5D, 

};



/*

INSTANTLY
UPON SEEING
YOUR SHIP,
THE WIZARDS
GIVE THE
ORDER TO
ATTACK!


TO DEFEAT
THE WIZARDS,
YOU MUST
REPEL THE
ALIEN ATTACK
AND PROTECT
THE WORLD
FROM DES-
TRUCTION.
YOU MUST
DESTROY AT
LEAST 99
ENEMIES AND
THE WORLD
MUST NOT BE
HIT MORE
THAN 10
TIMES.  USE
THE D-PAD TO
MOVE YOUR
SHIP AROUND
THE WORLD.
BUTTON A
WILL FIRE
AND BUTTON B
WILL RAISE
YOUR SHIELDS
BUT YOUR
SHIELD EN-
ERGY DRAINS
AS LONG AS
THEY ARE
RAISED. WHEN
YOUR SHIELDS
ARE DOWN,
YOUR SHIELD
ENERGY WILL
BE
REPLENISHED.
PRESS
START+L OR
START+R TO
ROTATE YOUR
SHIP LEFT OR
RIGHT.
GOOD LUCK!

*/


void doyesno35() ;

void dofinishgame()
{
	UBYTE ey, ex ;

	for ( ey = 0; ey != 16 ; ey++ )
	{
		for ( ex = 0; ex != 5 ; ex++ )
		{
			writegamemessage(finishgamedat+(((UWORD)ey)*60L)+((UWORD)(ex*12))) ;
		}
		waitpadup() ;
		waitpad(0xFF) ;
	}

	writegamemessage(finishgamedat+(((UWORD)16)*60L)+((UWORD)(0*12))) ;
	waitpadup() ;
	waitpad(0xFF) ;

	yesnoglobal = 1 ;

	while ( yesnoglobal==1 )
	{

		for ( ey = 0; ey != 9 ; ey++ )
		{
			for ( ex = 0; ex != 5 ; ex++ )
			{
				writegamemessage(instructionsdat+(((UWORD)ey)*60L)+((UWORD)(ex*12))) ;
			}
			waitpadup() ;
			waitpad(0xFF) ;
		}

		for ( ex = 0; ex != 5 ; ex++ )
		{
			writegamemessage(repeatdat+((UWORD)(ex*12))) ;
		}

		remoteCall ( 28, 35, doyesno35 ) ;
	}


}

unsigned char missingpiecesdat[] = {
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'L'+0x1D,'A'+0x1D,'C'+0x1D,'K'+0x1D,0x5D,0x5D,0x5D,0x5D, 
	'S'+0x1D,'O'+0x1D,'M'+0x1D,'E'+0x1D,0x5D,'P'+0x1D,'I'+0x1D,'E'+0x1D,'C'+0x1D,'E'+0x1D,'S'+0x1D,0x82U, 

};

unsigned char youhavedat[] = {
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'H'+0x1D,'A'+0x1D,'V'+0x1D,'E'+0x1D,0x5D,0x5D,0x5D,0x5D, 
} ;

unsigned char nothingdat28[] = {
	'N'+0x1D,'O'+0x1D,'T'+0x1D,'H'+0x1D,'I'+0x1D,'N'+0x1D,'G'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D, 
} ;

unsigned char piecesdat28[] = {
	'P'+0x1D,'I'+0x1D,'E'+0x1D,'C'+0x1D,'E'+0x1D,0x5D,'A'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'P'+0x1D,'I'+0x1D,'E'+0x1D,'C'+0x1D,'E'+0x1D,0x5D,'B'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'P'+0x1D,'I'+0x1D,'E'+0x1D,'C'+0x1D,'E'+0x1D,0x5D,'C'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D, 
	'P'+0x1D,'I'+0x1D,'E'+0x1D,'C'+0x1D,'E'+0x1D,0x5D,'D'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D, 
} ;

UBYTE doextraother( UBYTE thecode )
{

	UBYTE pnum, action ;
	unsigned char focustxt[13] ;

	pnum = (thecode>>4) - 1 ;

	action = thecode & 0x0F ;

	switch ( action )
	{
		case 0 : //score
			{
				writegamemessage(youhavedat) ;
				if ( ( party_specials & 0xFF00 ) == 0L )
				{
					writegamemessage(nothingdat28) ;
				}
				else
				{
					for ( pnum = 0 ; pnum < 4 ; pnum++ )
					{
						if ( ( party_specials >> (8+pnum) ) & 0x01 )
						{
							writegamemessage(piecesdat28 + (UWORD)(pnum*12)) ;
						}
					}

				}
				break ;
			}

		case 1 : //focus
			{
				memset(focustxt,0x5D,13) ;
				formatnumber28( (UWORD)playerx, 2 ) ;
				focustxt[0] = screenbuf3[0] ;
				focustxt[1] = screenbuf3[1] ;
				formatnumber28( (UWORD)playery, 2 ) ;
				focustxt[3] = screenbuf3[0] ;
				focustxt[4] = screenbuf3[1] ;
				focustxt[2] = 0x85U ;
				writegamemessage(focustxt) ;
				break ;
			}
		case 2 : //climb
			{
				return doclimb() ;
				break ;
			}
		case 3 : //freeze
			{
				return dofreeze() ;
				break ;
			}
		case 4 : //force
			{
				return doforce() ;
				break ;
			}
		case 5 : //omnieye
			{
				omnieye = 10 ;
				break ;
			}
		case 6 : //absorb
			{
				return doabsorb() ;
				break ;
			}
		case 7 : //build
			{
				if ( ( party_specials >> 8 ) == 0x0F )
				{
					dofinishgame() ;
					return 0xFFU ;
				}
				else
				{
					writegamemessage(missingpiecesdat) ;
					writegamemessage(missingpiecesdat+12UL) ;
				}

				break ;
			}
		case 8 : //bow
			{
				return dobow(pnum) ;
				break ;
			}
		default : break ;

	}

	return 1; 
}

void draw_border()
{
	UBYTE n ;

	VBK_REG = 1;		// select palette bank 

	memset(screenbuf3,0,20L) ;
	for ( n = 0 ; n<18 ; n++ )
		set_bkg_tiles2( 0, n, 20, 1, (unsigned char*)screenbuf3 );

	VBK_REG = 0;		// select palette bank 

	memset(screenbuf3,0x5dU,20L) ;
	for ( n = 0 ; n<18 ; n++ )
		set_bkg_tiles2( 0, n, 20, 1, (unsigned char*)screenbuf3 );


	screenbuf3[0] = 0x94U ;
	set_bkg_tiles2(0,0,1,1,(unsigned char*)screenbuf3) ;

	screenbuf3[0] = 0x95U ;
	for ( n=0 ; n<19 ; n++ )
	{
		set_bkg_tiles2(n+1,0,1,1,(unsigned char*)screenbuf3) ;
		if ( n<11 )
			set_bkg_tiles2(n+1,12,1,1,(unsigned char*)screenbuf3) ;
		else
			set_bkg_tiles2(n+1,17,1,1,(unsigned char*)screenbuf3) ;
	}

	screenbuf3[0] = 0x96U ;
	set_bkg_tiles2(12,0,1,1,(unsigned char*)screenbuf3) ;

	screenbuf3[0] = 0x97U ;
	for ( n=1 ; n<17 ; n++ )
	{
		if ( n<12 )
			set_bkg_tiles2(0,n,1,1,(unsigned char*)screenbuf3) ;
		set_bkg_tiles2(12,n,1,1,(unsigned char*)screenbuf3) ;

	}

	screenbuf3[0] = 0x98U ;
	set_bkg_tiles2(12,12,1,1,(unsigned char*)screenbuf3) ;

	screenbuf3[0] = 0x99U ;
	set_bkg_tiles2(0,12,1,1,(unsigned char*)screenbuf3) ;
	set_bkg_tiles2(12,17,1,1,(unsigned char*)screenbuf3) ;

	screenbuf3[0] = 0x9EU ;
	set_bkg_tiles2(4,12,1,1,(unsigned char*)screenbuf3) ;
	screenbuf3[0] = 0x9FU ;
	set_bkg_tiles2(5,12,1,1,(unsigned char*)screenbuf3) ;

	set_bkg_tiles2( 3,0,7,1, moondat) ;


}

unsigned char secret_door_locations_dat[] = {
// peermap, playerx, playery, direction	(33=N, 35=W, 37=E, 39=S)
	0,  26, 55, 39,	//castle1 passageway
	0,  38, 55, 39,	//castle1 passageway
	0,  16, 21, 33,	//castle1 room1
	0,  47, 21, 33,	//castle1 room2
	2,  3,  9,  37,	//castle2 to the mountains
	2,  6,  22, 35,	//castke2 out of guard square
	2,  5,  22, 35,	//castle2 out of guard square
	2,  10, 22, 35,	//castle2 out of guard square
	4,  31, 40, 35,	//castle3 to left
	4,  33, 40, 37,	//castle3 to right
	6,  24, 6,  39,	//castle4 hidden person
	6,  40, 6,  39,	//castle4 hidden person
	6,  52, 2,  37,	//castle4 little pocket in NE corner
	8,  9,  14, 37,	//LCB grass section by ship
	8,  25, 57, 33,	//LCB BEEF door
	8,  21, 26, 35,	//LCB to ship
	9,  51, 57, 33,	//rudan guy by healer
	9,  6, 60, 37,	//rudan grace/courtesy
	10, 16, 3, 39,	//britain 1 of 4
	10, 48, 3, 39,	//britain 1 of 4
	10, 16, 57, 33,	//britain 1 of 4
	10, 48, 57, 33,	//britain 1 of 4
	11, 4, 52, 39,	//town confusion to wizard
	11, 7, 21, 35,	//town confusion to guard
	13, 13, 61, 39,	//proul hidden guy
	13, 19, 26, 37,	//proul hidden guy in theater
	14, 2, 1, 35,  //town pirate stronghold to outside
	14, 23, 55, 35,	//town pirate stronghold to ship
	14, 34, 62, 35,	//town pirate stronghold to person
	15, 23, 13, 35,	//olympus main exits
	15, 24, 15, 39,	//olympus main exits
	15, 41, 7,  37,	//olympus main exits
	15, 40, 15, 39,	//olympus main exits
} ;

#define NUMDOORS 33




unsigned char foundsecretmsg[] = {
	'Y'+0x1D,'O'+0x1D,'U'+0x1D,0x5D,'F'+0x1D,'O'+0x1D,'U'+0x1D,'N'+0x1D,'D'+0x1D,0x5D,'A'+0x1D,0x5D, 
	'S'+0x1D,'E'+0x1D,'C'+0x1D,'R'+0x1D,'E'+0x1D,'T'+0x1D,0x5D,'D'+0x1D,'O'+0x1D,'O'+0x1D,'R'+0x1D,0x82U, 
};

unsigned char walldat[] = {
	'W'+0x1D,'A'+0x1D,'L'+0x1D,'L'+0x1D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D,0x5D, 
} ;

UBYTE dosecretdoor( UBYTE dir, UBYTE looking )
{
	UBYTE kk ;
	unsigned char atile, btile ;
	UBYTE currx, curry, mapx, mapy ;

	for ( kk = 0 ; kk < NUMDOORS ; kk++ )
	{

		if
			 ( 
			 ( secret_door_locations_dat[ kk<<2       ] == peermap ) &&
			 ( secret_door_locations_dat[ (kk<<2) + 1 ] == playerx ) &&
			 ( secret_door_locations_dat[ (kk<<2) + 2 ] == playery ) &&
			 ( secret_door_locations_dat[ (kk<<2) + 3 ] == dir ) 
			 )
		{
			writegamemessage(foundsecretmsg) ;
			writegamemessage(foundsecretmsg+12UL) ;


			atile = 0x0b ;
			btile = 0 ;


			currx = 5 ;
			curry = 5 ;
			mapx = playerx ;
			mapy = playery ;

			switch ( dir )
			{
				case 0x21 :
					{
						curry-- ;
						mapy = (mapy-1)&0x3F ;
						break ;
					}
				case 0x23 :
					{
						currx-- ;
						mapx = (mapx-1)&0x3F ;
						break ;
					}
				case 0x25 :
					{
						currx++ ;
						mapx = (mapx+1)&0x3F ;
						break ;
					}
				case 0x27 :
					{
						curry++ ;
						mapy = (mapy+1)&0x3F ;
						break ;
					}
				default : break ;
			}


			disable_interrupts2() ;
			set_bkg_tiles2( currx+1,curry+1,1,1,&atile ) ;
			*((unsigned char*)0xA000+((UWORD)(((UWORD)(mapy))<<6))+(UWORD)(mapx)) = atile ;
			VBK_REG=1 ;
			set_bkg_tiles2(currx+1,curry+1,1,1,&btile) ;
			VBK_REG=0 ;
			SWITCH_RAM_MBC5(3) ;
			*((unsigned char*)0xA000+((UWORD)(((UWORD)(mapy))<<6))+(UWORD)(mapx)) = atile ;
			SWITCH_RAM_MBC5(1) ;
			enable_interrupts2() ;

			specialsfx() ;

			return 1 ;

		}


	}

	if ( looking )
	{
		writegamemessage( walldat ) ;
		return 1 ;
	}
	else
		return 0 ;
}

void specialsfx28()
{
	changemusic = 34 ;

	delay(4200) ;

	changemusic = calcmusic( peermap ) ;

}

unsigned char forcefielddat[] =
{
	'F'+0x1D,'O'+0x1D,'R'+0x1D,'C'+0x1D,'E'+0x1D,0x5D,'F'+0x1D,'I'+0x1D,'E'+0x1D,'L'+0x1D,'D'+0x1D,0x82
};

UBYTE validmove28(UBYTE dir)
{
	UBYTE mask ;
	UBYTE atile ;
	UBYTE forceOK ;

	if ( cheat_noblock != 0 )
		return 1 ;

	if ( transport==1 )	//ship
	{
		if ( (winddir==0)||((winddir==1)&&(dir==1)) ||
			 ((winddir==2)&&(dir==7)) ||
			 ((winddir==3)&&(dir==5)) ||
			 ((winddir==4)&&(dir==3)) )
			return 0 ;
		mask = 0x02 ;
	}
	else
		mask = 0x01 ;

	disable_interrupts2() ;
	get_bkg_tiles2(5,5,3,3,screenbuf3) ;
	enable_interrupts2() ;

	atile = *(screenbuf3+(UWORD)dir) ;

	if ( atile==0x26 )
	{
		forceOK = 1 ;
		for ( mask = 0 ; mask < numplayers ; mask++ )
			if ( !((players[mask].markcard)&MARKFORCE) )
			{
				if ( forceOK!=0 )
				{
					writegamemessage(forcefielddat) ;
					forcefieldsfx(170U) ;
				}
				if ( players[mask].status<2 )
				{
					damageplayer28(mask,99) ;
					flashchar28(mask,0) ;
				}
				forceOK=0 ;

			}
		return forceOK ;
	}

	if ( ( atile==0x3A ) && ( extragame != 0 ) ) //wall
	{
		return dosecretdoor(dir|0x20,0) ;
	}

	//return 1 ;

	return((tile_attribs[atile])&mask) ;



}
